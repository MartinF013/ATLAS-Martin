{
  "version": 3,
  "sources": ["../../@arcgis/core/renderers/support/heatmapUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{clamp as t}from\"../../core/mathUtils.js\";import{px2pt as r,pt2px as n}from\"../../core/screenUtils.js\";import{l as o}from\"../../chunks/vec4.js\";import{c as e}from\"../../chunks/vec4f64.js\";const a=2.4;function i(t){return r(t*a)}function f(t){return n(t)/a}function c(r,n,e,a){let{color:i,ratio:f}=n,{color:c,ratio:s}=e;if(s===f){const t=1e-6;1===s?f-=t:s+=t}const u=t((a-f)/(s-f),0,1);o(r,i.toArray(),c.toArray(),u)}function s(t){const r=512,n=new Uint8ClampedArray(4*r);if(t=t.filter((({ratio:t})=>t>=0&&t<=1)).sort(((t,r)=>t.ratio-r.ratio)).map((({color:t,ratio:r})=>({color:t,ratio:Math.max(r,.001)}))),t.length<1)return n;let o=t[0],a=t[0],i=1;const f=e();for(let e=0;e<r;e++){const s=(e+.5)/r;for(;s>a.ratio&&i<t.length;)o=a,a=t[i++];c(f,o,a,s),n.set(f,4*e)}return n}function u(t,r,o,e){const{radius:a,fieldOffset:i,field:f}=r,c=n(a),s=new Float64Array(o*e);let u,l=Number.NEGATIVE_INFINITY;const m=d(f,i);for(const{geometry:n,attributes:h}of t){const t=Math.max(0,n.x-c),r=Math.max(0,n.y-c),a=Math.min(e,n.y+c),i=Math.min(o,n.x+c),f=+m(h);for(let e=r;e<a;e++)for(let r=t;r<i;r++){const t=e*o+r,a=y(n.x-r,n.y-e,c);u=s[t]+=a*f,u>l&&(l=u)}}return{matrix:s.buffer,max:l}}function l(t,r,o,e){const{radius:a,fieldOffset:i,field:f}=r,c=Math.round(n(a)),s=new Float64Array(o*e);let u,l=Number.NEGATIVE_INFINITY;const m=x(f,i),h=new Set;for(const n of t){const t=n.getCursor();for(;t.next();){const r=t.getObjectId();if(h.has(r))continue;h.add(r);const n=t.readLegacyPointGeometry(),a=128;if(n.x<-a||n.x>=o+a||n.y<-a||n.y>e+a)continue;const i=+m(t),f=Math.max(0,Math.round(n.x)-c),d=Math.max(0,Math.round(n.y)-c),x=Math.min(e,Math.round(n.y)+c),M=Math.min(o,Math.round(n.x)+c);for(let t=d;t<x;t++)for(let r=f;r<M;r++){const e=t*o+r,a=y(n.x-r,n.y-t,c);u=s[e]+=a*i,u>l&&(l=u)}}}return{matrix:s.buffer,max:l}}function m(t,r,n,o,e,a){t.canvas.width=t.canvas.height=r,t.clearRect(0,0,r,r);const i=t.getImageData(0,0,r,r);n&&o&&i.data.set(new Uint8ClampedArray(h(r,n,o,e,a))),t.putImageData(i,0,0)}function h(r,n,o,e,a){const i=new Uint32Array(r*r),f=\"buffer\"in n?n:new Float64Array(n),c=\"buffer\"in o?new Uint32Array(o.buffer):new Uint32Array(new Uint8Array(o).buffer),s=c.length/(a-e);for(let u=0;u<f.length;u++){const r=f[u],n=Math.floor((r-e)*s);i[u]=c[t(n,0,c.length-1)]}return i.buffer}function y(t,r,n){const o=Math.sqrt(t**2+r**2)/n;return o>1?0:3/(Math.PI*n**2)*(1-o**2)**2}function d(t,r){return\"function\"==typeof t?t:t?\"string\"==typeof r?r=>-1*+r[t]:n=>+n[t]+r:()=>1}function x(t,r){return null!=t?\"string\"==typeof r?r=>-1*+r.readAttribute(t):n=>+n.readAttribute(t)+r:t=>1}export{a as MAGIC_KERNEL_DENSITY_RADIUS_INFLATION_FACTOR,u as calculateHeatmapIntensityInfo,l as calculateHeatmapIntensityInfoReaders,h as createHeatmapImageData,d as createValueFunction,x as createValueFunctionCursor,m as drawHeatmap,y as evaluateDensityKernel,i as gaussianBlurRadiusPxToKernelDensityRadiusPt,s as generateGradient,f as kernelDensityRadiusPtToGaussianBlurRadiusPx};\n"],
  "mappings": ";;;;;;;;;;;;;;;AAIkM,IAAM,IAAE;AAAI,SAAS,EAAE,GAAE;AAAC,SAAO,EAAE,IAAE,CAAC;AAAC;AAAC,SAAS,EAAE,GAAE;AAAC,SAAO,EAAE,CAAC,IAAE;AAAC;AAAC,SAAS,EAAE,GAAEA,IAAEC,IAAEC,IAAE;AAAC,MAAG,EAAC,OAAMC,IAAE,OAAMC,GAAC,IAAEJ,IAAE,EAAC,OAAMK,IAAE,OAAMC,GAAC,IAAEL;AAAE,MAAGK,OAAIF,IAAE;AAAC,UAAM,IAAE;AAAK,UAAIE,KAAEF,MAAG,IAAEE,MAAG;AAAA,EAAC;AAAC,QAAMC,KAAE,GAAGL,KAAEE,OAAIE,KAAEF,KAAG,GAAE,CAAC;AAAE,IAAE,GAAED,GAAE,QAAQ,GAAEE,GAAE,QAAQ,GAAEE,EAAC;AAAC;AAAC,SAAS,EAAE,GAAE;AAAC,QAAM,IAAE,KAAIP,KAAE,IAAI,kBAAkB,IAAE,CAAC;AAAE,MAAG,IAAE,EAAE,OAAQ,CAAC,EAAC,OAAMQ,GAAC,MAAIA,MAAG,KAAGA,MAAG,CAAE,EAAE,KAAM,CAACA,IAAEC,OAAID,GAAE,QAAMC,GAAE,KAAM,EAAE,IAAK,CAAC,EAAC,OAAMD,IAAE,OAAMC,GAAC,OAAK,EAAC,OAAMD,IAAE,OAAM,KAAK,IAAIC,IAAE,IAAI,EAAC,EAAG,GAAE,EAAE,SAAO;AAAE,WAAOT;AAAE,MAAIU,KAAE,EAAE,CAAC,GAAER,KAAE,EAAE,CAAC,GAAEC,KAAE;AAAE,QAAMC,KAAE,EAAE;AAAE,WAAQH,KAAE,GAAEA,KAAE,GAAEA,MAAI;AAAC,UAAMK,MAAGL,KAAE,OAAI;AAAE,WAAKK,KAAEJ,GAAE,SAAOC,KAAE,EAAE;AAAQ,MAAAO,KAAER,IAAEA,KAAE,EAAEC,IAAG;AAAE,MAAEC,IAAEM,IAAER,IAAEI,EAAC,GAAEN,GAAE,IAAII,IAAE,IAAEH,EAAC;AAAA,EAAC;AAAC,SAAOD;AAAC;AAAkZ,SAAS,EAAE,GAAE,GAAEW,IAAEC,IAAE;AAAC,QAAK,EAAC,QAAOC,IAAE,aAAYC,IAAE,OAAMC,GAAC,IAAE,GAAEC,KAAE,KAAK,MAAM,EAAEH,EAAC,CAAC,GAAEI,KAAE,IAAI,aAAaN,KAAEC,EAAC;AAAE,MAAIM,IAAEC,KAAE,OAAO;AAAkB,QAAMC,KAAE,EAAEL,IAAED,EAAC,GAAEO,KAAE,oBAAI;AAAI,aAAUC,MAAK,GAAE;AAAC,UAAMC,KAAED,GAAE,UAAU;AAAE,WAAKC,GAAE,KAAK,KAAG;AAAC,YAAMC,KAAED,GAAE,YAAY;AAAE,UAAGF,GAAE,IAAIG,EAAC;AAAE;AAAS,MAAAH,GAAE,IAAIG,EAAC;AAAE,YAAMF,KAAEC,GAAE,wBAAwB,GAAEV,KAAE;AAAI,UAAGS,GAAE,IAAE,CAACT,MAAGS,GAAE,KAAGX,KAAEE,MAAGS,GAAE,IAAE,CAACT,MAAGS,GAAE,IAAEV,KAAEC;AAAE;AAAS,YAAMC,KAAE,CAACM,GAAEG,EAAC,GAAER,KAAE,KAAK,IAAI,GAAE,KAAK,MAAMO,GAAE,CAAC,IAAEN,EAAC,GAAES,KAAE,KAAK,IAAI,GAAE,KAAK,MAAMH,GAAE,CAAC,IAAEN,EAAC,GAAEU,KAAE,KAAK,IAAId,IAAE,KAAK,MAAMU,GAAE,CAAC,IAAEN,EAAC,GAAE,IAAE,KAAK,IAAIL,IAAE,KAAK,MAAMW,GAAE,CAAC,IAAEN,EAAC;AAAE,eAAQO,KAAEE,IAAEF,KAAEG,IAAEH;AAAI,iBAAQC,KAAET,IAAES,KAAE,GAAEA,MAAI;AAAC,gBAAMZ,KAAEW,KAAEZ,KAAEa,IAAEX,KAAE,EAAES,GAAE,IAAEE,IAAEF,GAAE,IAAEC,IAAEP,EAAC;AAAE,UAAAE,KAAED,GAAEL,EAAC,KAAGC,KAAEC,IAAEI,KAAEC,OAAIA,KAAED;AAAA,QAAE;AAAA,IAAC;AAAA,EAAC;AAAC,SAAM,EAAC,QAAOD,GAAE,QAAO,KAAIE,GAAC;AAAC;AAAC,SAAS,EAAE,GAAE,GAAEG,IAAEX,IAAEC,IAAEC,IAAE;AAAC,IAAE,OAAO,QAAM,EAAE,OAAO,SAAO,GAAE,EAAE,UAAU,GAAE,GAAE,GAAE,CAAC;AAAE,QAAMC,KAAE,EAAE,aAAa,GAAE,GAAE,GAAE,CAAC;AAAE,EAAAQ,MAAGX,MAAGG,GAAE,KAAK,IAAI,IAAI,kBAAkB,EAAE,GAAEQ,IAAEX,IAAEC,IAAEC,EAAC,CAAC,CAAC,GAAE,EAAE,aAAaC,IAAE,GAAE,CAAC;AAAC;AAAC,SAAS,EAAE,GAAEQ,IAAEX,IAAEC,IAAEC,IAAE;AAAC,QAAMC,KAAE,IAAI,YAAY,IAAE,CAAC,GAAEC,KAAE,YAAWO,KAAEA,KAAE,IAAI,aAAaA,EAAC,GAAEN,KAAE,YAAWL,KAAE,IAAI,YAAYA,GAAE,MAAM,IAAE,IAAI,YAAY,IAAI,WAAWA,EAAC,EAAE,MAAM,GAAEM,KAAED,GAAE,UAAQH,KAAED;AAAG,WAAQM,KAAE,GAAEA,KAAEH,GAAE,QAAOG,MAAI;AAAC,UAAMM,KAAET,GAAEG,EAAC,GAAEI,KAAE,KAAK,OAAOE,KAAEZ,MAAGK,EAAC;AAAE,IAAAH,GAAEI,EAAC,IAAEF,GAAE,EAAEM,IAAE,GAAEN,GAAE,SAAO,CAAC,CAAC;AAAA,EAAC;AAAC,SAAOF,GAAE;AAAM;AAAC,SAAS,EAAE,GAAE,GAAEQ,IAAE;AAAC,QAAMX,KAAE,KAAK,KAAK,KAAG,IAAE,KAAG,CAAC,IAAEW;AAAE,SAAOX,KAAE,IAAE,IAAE,KAAG,KAAK,KAAGW,MAAG,MAAI,IAAEX,MAAG,MAAI;AAAC;AAAC,SAAS,EAAE,GAAE,GAAE;AAAC,SAAM,cAAY,OAAO,IAAE,IAAE,IAAE,YAAU,OAAO,IAAE,CAAAa,OAAG,KAAG,CAACA,GAAE,CAAC,IAAE,CAAAF,OAAG,CAACA,GAAE,CAAC,IAAE,IAAE,MAAI;AAAC;AAAC,SAAS,EAAE,GAAE,GAAE;AAAC,SAAO,QAAM,IAAE,YAAU,OAAO,IAAE,CAAAE,OAAG,KAAG,CAACA,GAAE,cAAc,CAAC,IAAE,CAAAF,OAAG,CAACA,GAAE,cAAc,CAAC,IAAE,IAAE,CAAAC,OAAG;AAAC;",
  "names": ["n", "e", "a", "i", "f", "c", "s", "u", "t", "r", "o", "o", "e", "a", "i", "f", "c", "s", "u", "l", "m", "h", "n", "t", "r", "d", "x"]
}
