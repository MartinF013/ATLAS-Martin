{
  "version": 3,
  "sources": ["../../@arcgis/core/views/webgl/VertexArrayObject.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport t from\"../../core/Logger.js\";import{isSome as e,disposeMaybe as i}from\"../../core/maybe.js\";import{ResourceType as r}from\"./enums.js\";import{bindVertexBufferLayout as s,unbindVertexBufferLayout as n}from\"./Util.js\";const o=t.getLogger(\"esri.views.webgl.VertexArrayObject\");class f{constructor(t,e,i,s,n=null){this._context=t,this._locations=e,this._layout=i,this._buffers=s,this._indexBuffer=n,this._glName=null,this._initialized=!1,t.instanceCounter.increment(r.VertexArrayObject,this)}get glName(){return this._glName}get context(){return this._context}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get size(){return Object.keys(this._buffers).reduce(((t,e)=>t+this._buffers[e].size),e(this._indexBuffer)?this._indexBuffer.size:0)}get layout(){return this._layout}get locations(){return this._locations}dispose(t=!0){if(!this._context)return void((this._glName||t&&Object.getOwnPropertyNames(this._buffers).length>0)&&o.warn(\"Leaked WebGL VAO\"));if(this._glName){const t=this._context?.capabilities?.vao;t?(t.deleteVertexArray(this._glName),this._glName=null):o.warn(\"Leaked WebGL VAO\")}if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),t){for(const t in this._buffers)this._buffers[t].dispose(),delete this._buffers[t];this._indexBuffer=i(this._indexBuffer)}this._context.instanceCounter.decrement(r.VertexArrayObject,this),this._context=null}initialize(){if(this._initialized)return;const t=this._context.capabilities.vao;if(t){const e=t.createVertexArray();t.bindVertexArray(e),this._bindLayout(),t.bindVertexArray(null),this._glName=e}this._initialized=!0}bind(){this.initialize();const t=this._context.capabilities.vao;t?t.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}_bindLayout(){const{_buffers:t,_layout:i,_indexBuffer:r}=this;t||o.error(\"Vertex buffer dictionary is empty!\");const n=this._context.gl;for(const e in t){const r=t[e];r||o.error(\"Vertex buffer is uninitialized!\");const n=i[e];n||o.error(\"Vertex element descriptor is empty!\"),s(this._context,this._locations,r,n)}if(e(r)){!!this._context.capabilities.vao?n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r.glName):this._context.bindBuffer(r)}}unbind(){this.initialize();const t=this._context.capabilities.vao;t?t.bindVertexArray(null):this._unbindLayout()}_unbindLayout(){const{_buffers:t,_layout:i}=this;t||o.error(\"Vertex buffer dictionary is empty!\");for(const e in t){const r=t[e];r||o.error(\"Vertex buffer is uninitialized!\");const s=i[e];n(this._context,this._locations,r,s)}e(this._indexBuffer)&&this._context.unbindBuffer(this._indexBuffer.bufferType)}}export{f as VertexArrayObject};\n"],
  "mappings": "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",
  "names": ["s", "t", "r", "n"]
}
