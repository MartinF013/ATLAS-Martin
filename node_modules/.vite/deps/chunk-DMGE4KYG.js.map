{
  "version": 3,
  "sources": ["../../@arcgis/core/views/layers/ImageryTileLayerView.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import e from\"../../Graphic.js\";import r from\"../../core/Error.js\";import{unwrap as i,isNone as o}from\"../../core/maybe.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as n}from\"../../layers/support/commonProperties.js\";import{getDefaultDatumTransformationForDataset as l,projectExtent as u}from\"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";import{getFetchPopupTemplate as p}from\"./support/popupUtils.js\";const m=m=>{let f=class extends m{constructor(){super(...arguments),this._rasterFieldPrefix=\"Raster.\",this.layer=null,this.view=null,this.tileInfo=null}get fullExtent(){return this._getfullExtent()}_getfullExtent(){return this.projectFullExtent(this.view.spatialReference)}get hasTilingEffects(){return this.layer.renderer&&\"dynamicRangeAdjustment\"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}get datumTransformation(){return l(i(this.layer.fullExtent),this.view.spatialReference,!0)}supportsSpatialReference(t){return!!this.projectFullExtent(t)}projectFullExtent(t){const e=i(this.layer.fullExtent),r=l(e,t,!1);return u(e,t,r)}async fetchPopupFeatures(t,i){const{layer:s}=this;if(!t)throw new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s});const{popupEnabled:a}=s,n=p(s,i);if(!a||o(n))throw new r(\"imageryTileLayerView:fetchPopupFeatures\",\"Missing required popupTemplate or popupEnabled\",{popupEnabled:a,popupTemplate:n});const l=[],{value:u,magdirValue:m}=await s.identify(t,{timeExtent:this.timeExtent});let f=\"\";if(u&&u.length){f=\"imagery-tile\"===s.type&&s.hasStandardTime()&&null!=u[0]?u.map((t=>s.getStandardTimeValue(t))).join(\", \"):u.join(\", \");const t={ObjectId:0},r=\"Raster.ServicePixelValue\";t[r]=this._formatAttributeValue(f,r);const i=s.rasterInfo?.attributeTable?.features;if(i&&i.length>0){const e=i.filter((t=>{const e=t.attributes.value||t.attributes.Value||t.attributes.VALUE;return String(e)===f}));if(e.length>0){const r=e[0];if(r)for(const e in r.attributes)if(r.attributes.hasOwnProperty(e)){const i=this._rasterFieldPrefix+e;t[i]=this._formatAttributeValue(r.attributes[e],i)}}}const o=s.rasterInfo.dataType;\"vector-magdir\"!==o&&\"vector-uv\"!==o||(t[\"Raster.Magnitude\"]=m?.[0],t[\"Raster.Direction\"]=m?.[1]);const a=new e(this.fullExtent.clone(),null,t);a.layer=s,a.sourceLayer=a.layer,l.push(a)}return l}_formatAttributeValue(t,e){if(\"string\"==typeof t){const r=this.layer.popupTemplate&&this.layer.popupTemplate.fieldInfos,i=this._getFieldInfo(r,e),o=i&&i.format;if(o){let e,r;return t.trim().includes(\",\")?(e=\",\",r=e+\" \",this._formatDelimitedString(t,e,r,o)):t.trim().includes(\" \")?(e=r=\" \",this._formatDelimitedString(t,e,r,o)):this._formatNumberFromString(t,o)}}return t}_getFieldInfo(t,e){if(!t||!t.length||!e)return;const r=e.toLowerCase();let i;return t.some((t=>!(!t.fieldName||t.fieldName.toLowerCase()!==r&&t.fieldName.toLowerCase()!==r.replace(/ /g,\"_\"))&&(i=t,!0))),i}_formatDelimitedString(t,e,r,i){return t&&e&&r&&i?t.trim().split(e).map((t=>this._formatNumberFromString(t,i))).join(r):t}_formatNumberFromString(t,e){if(!t||!e)return t;const r=Number(t);return isNaN(r)?t:e.format(r)}};return t([s()],f.prototype,\"layer\",void 0),t([s(n)],f.prototype,\"timeExtent\",void 0),t([s()],f.prototype,\"view\",void 0),t([s()],f.prototype,\"fullExtent\",null),t([s()],f.prototype,\"tileInfo\",void 0),t([s({readOnly:!0})],f.prototype,\"hasTilingEffects\",null),f=t([a(\"esri.views.layers.ImageryTileLayerView\")],f),f};export{m as default};\n"],
  "mappings": "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",
  "names": ["m", "e", "t", "s", "n", "f", "i", "r", "a", "g"]
}
