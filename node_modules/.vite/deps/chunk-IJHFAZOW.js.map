{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{unwrap as e,isNone as s,isSome as i}from\"../../../../../core/maybe.js\";import{j as a}from\"../../../../../chunks/mat4.js\";import{c as o}from\"../../../../../chunks/mat4f64.js\";import{s as c,b as r,m as l,a as t}from\"../../../../../chunks/vec3.js\";import{Z as n,c as f}from\"../../../../../chunks/vec3f64.js\";import{Float3DrawUniform as d}from\"../shaderModules/Float3DrawUniform.js\";import{Float3PassUniform as _}from\"../shaderModules/Float3PassUniform.js\";import{NoParameters as P,glsl as h}from\"../shaderModules/interfaces.js\";class m extends P{constructor(e){super(),this.slicePlaneLocalOrigin=e}}function p(s,i){H(s,i,[new _(\"slicePlaneOrigin\",((e,s)=>v(i,e,s))),new _(\"slicePlaneBasis1\",((s,a)=>B(i,s,a,e(a.slicePlane)?.basis1))),new _(\"slicePlaneBasis2\",((s,a)=>B(i,s,a,e(a.slicePlane)?.basis2)))])}function u(s,i){H(s,i,[new d(\"slicePlaneOrigin\",((e,s)=>v(i,e,s))),new d(\"slicePlaneBasis1\",((s,a)=>B(i,s,a,e(a.slicePlane)?.basis1))),new d(\"slicePlaneBasis2\",((s,a)=>B(i,s,a,e(a.slicePlane)?.basis2)))])}function H(e,s,i){if(!s.hasSlicePlane){const i=h`#define rejectBySlice(_pos_) false\n#define discardBySlice(_pos_) {}\n#define highlightSlice(_color_, _pos_) (_color_)`;return s.hasSliceInVertexProgram&&e.vertex.code.add(i),void e.fragment.code.add(i)}e.extensions.add(\"GL_OES_standard_derivatives\"),s.hasSliceInVertexProgram&&e.vertex.uniforms.add(i),e.fragment.uniforms.add(i);const a=h`struct SliceFactors {\nfloat front;\nfloat side0;\nfloat side1;\nfloat side2;\nfloat side3;\n};\nSliceFactors calculateSliceFactors(vec3 pos) {\nvec3 rel = pos - slicePlaneOrigin;\nvec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);\nfloat slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);\nfloat basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);\nfloat basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);\nfloat basis1Dot = dot(slicePlaneBasis1, rel);\nfloat basis2Dot = dot(slicePlaneBasis2, rel);\nreturn SliceFactors(\ndot(slicePlaneNormal, pos) + slicePlaneW,\n-basis1Dot - basis1Len2,\nbasis1Dot - basis1Len2,\n-basis2Dot - basis2Len2,\nbasis2Dot - basis2Len2\n);\n}\nbool sliceByFactors(SliceFactors factors) {\nreturn factors.front < 0.0\n&& factors.side0 < 0.0\n&& factors.side1 < 0.0\n&& factors.side2 < 0.0\n&& factors.side3 < 0.0;\n}\nbool sliceEnabled() {\nreturn dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;\n}\nbool sliceByPlane(vec3 pos) {\nreturn sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));\n}\n#define rejectBySlice(_pos_) sliceByPlane(_pos_)\n#define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }`,o=h`vec4 applySliceHighlight(vec4 color, vec3 pos) {\nSliceFactors factors = calculateSliceFactors(pos);\nconst float HIGHLIGHT_WIDTH = 1.0;\nconst vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);\nfactors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\nfactors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\nfactors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\nfactors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\nfactors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\nif (sliceByFactors(factors)) {\nreturn color;\n}\nfloat highlightFactor = (1.0 - step(0.5, factors.front))\n* (1.0 - step(0.5, factors.side0))\n* (1.0 - step(0.5, factors.side1))\n* (1.0 - step(0.5, factors.side2))\n* (1.0 - step(0.5, factors.side3));\nreturn mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n}`,c=s.hasSliceHighlight?h`\n        ${o}\n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      `:h`#define highlightSlice(_color_, _pos_) (_color_)`;s.hasSliceInVertexProgram&&e.vertex.code.add(a),e.fragment.code.add(a),e.fragment.code.add(c)}function g(e,s,i){return e.instancedDoublePrecision?c(S,i.camera.viewInverseTransposeMatrix[3],i.camera.viewInverseTransposeMatrix[7],i.camera.viewInverseTransposeMatrix[11]):s.slicePlaneLocalOrigin}function I(e,s){return i(e)?r(L,s.origin,e):s.origin}function b(e,s,o){return e.hasSliceTranslatedView?i(s)?a(T,o.camera.viewMatrix,s):o.camera.viewMatrix:null}function v(e,a,o){if(s(o.slicePlane))return n;const c=g(e,a,o),r=I(c,o.slicePlane),t=b(e,c,o);return i(t)?l(L,r,t):r}function B(e,a,o,c){if(s(c)||s(o.slicePlane))return n;const f=g(e,a,o),d=I(f,o.slicePlane),_=b(e,f,o);return i(_)?(t(G,c,d),l(L,d,_),l(G,G,_),r(G,G,L)):c}const S=f(),L=f(),G=f(),T=o();export{u as SliceDraw,p as SlicePass,m as SlicePlaneParameters};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIohB,IAAM,IAAN,cAAgBA,GAAC;AAAA,EAAC,YAAYC,IAAE;AAAC,UAAM,GAAE,KAAK,wBAAsBA;AAAA,EAAC;AAAC;AAAC,SAAS,EAAE,GAAE,GAAE;AAAC,IAAE,GAAE,GAAE,CAAC,IAAIA,GAAE,oBAAoB,CAACA,IAAEC,OAAI,EAAE,GAAED,IAAEC,EAAC,CAAE,GAAE,IAAID,GAAE,oBAAoB,CAACC,IAAE,MAAE;AAJ7rB;AAI+rB,aAAE,GAAEA,IAAE,IAAE,OAAE,EAAE,UAAU,MAAd,mBAAiB,MAAM;AAAA,GAAE,GAAE,IAAID,GAAE,oBAAoB,CAACC,IAAE,MAAE;AAJjwB;AAImwB,aAAE,GAAEA,IAAE,IAAE,OAAE,EAAE,UAAU,MAAd,mBAAiB,MAAM;AAAA,GAAE,CAAC,CAAC;AAAC;AAAC,SAASC,GAAE,GAAE,GAAE;AAAC,IAAE,GAAE,GAAE,CAAC,IAAIC,GAAE,oBAAoB,CAACH,IAAEC,OAAI,EAAE,GAAED,IAAEC,EAAC,CAAE,GAAE,IAAIE,GAAE,oBAAoB,CAACF,IAAE,MAAE;AAJ14B;AAI44B,aAAE,GAAEA,IAAE,IAAE,OAAE,EAAE,UAAU,MAAd,mBAAiB,MAAM;AAAA,GAAE,GAAE,IAAIE,GAAE,oBAAoB,CAACF,IAAE,MAAE;AAJ98B;AAIg9B,aAAE,GAAEA,IAAE,IAAE,OAAE,EAAE,UAAU,MAAd,mBAAiB,MAAM;AAAA,GAAE,CAAC,CAAC;AAAC;AAAC,SAAS,EAAED,IAAE,GAAE,GAAE;AAAC,MAAG,CAAC,EAAE,eAAc;AAAC,UAAMI,KAAEC;AAAA;AAAA;AAEl/B,WAAO,EAAE,2BAAyBL,GAAE,OAAO,KAAK,IAAII,EAAC,GAAE,KAAKJ,GAAE,SAAS,KAAK,IAAII,EAAC;AAAA,EAAC;AAAC,EAAAJ,GAAE,WAAW,IAAI,6BAA6B,GAAE,EAAE,2BAAyBA,GAAE,OAAO,SAAS,IAAI,CAAC,GAAEA,GAAE,SAAS,SAAS,IAAI,CAAC;AAAE,QAAM,IAAEK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sEAqCvMF,KAAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAkBpEC,KAAE,EAAE,oBAAkBD;AAAA,UACfF;AAAA;AAAA,UAEFE;AAAoD,IAAE,2BAAyBL,GAAE,OAAO,KAAK,IAAI,CAAC,GAAEA,GAAE,SAAS,KAAK,IAAI,CAAC,GAAEA,GAAE,SAAS,KAAK,IAAIM,EAAC;AAAC;AAAC,SAAS,EAAEN,IAAE,GAAE,GAAE;AAAC,SAAOA,GAAE,2BAAyB,EAAE,GAAE,EAAE,OAAO,2BAA2B,CAAC,GAAE,EAAE,OAAO,2BAA2B,CAAC,GAAE,EAAE,OAAO,2BAA2B,EAAE,CAAC,IAAE,EAAE;AAAqB;AAAC,SAAS,EAAEA,IAAE,GAAE;AAAC,SAAO,EAAEA,EAAC,IAAEA,GAAEO,IAAE,EAAE,QAAOP,EAAC,IAAE,EAAE;AAAM;AAAC,SAAS,EAAEA,IAAE,GAAEG,IAAE;AAAC,SAAOH,GAAE,yBAAuB,EAAE,CAAC,IAAE,EAAE,GAAEG,GAAE,OAAO,YAAW,CAAC,IAAEA,GAAE,OAAO,aAAW;AAAI;AAAC,SAAS,EAAEH,IAAE,GAAEG,IAAE;AAAC,MAAG,EAAEA,GAAE,UAAU;AAAE,WAAO;AAAE,QAAMG,KAAE,EAAEN,IAAE,GAAEG,EAAC,GAAEK,KAAE,EAAEF,IAAEH,GAAE,UAAU,GAAEJ,KAAE,EAAEC,IAAEM,IAAEH,EAAC;AAAE,SAAO,EAAEJ,EAAC,IAAE,EAAEQ,IAAEC,IAAET,EAAC,IAAES;AAAC;AAAC,SAAS,EAAER,IAAE,GAAEG,IAAEG,IAAE;AAAC,MAAG,EAAEA,EAAC,KAAG,EAAEH,GAAE,UAAU;AAAE,WAAO;AAAE,QAAMM,KAAE,EAAET,IAAE,GAAEG,EAAC,GAAE,IAAE,EAAEM,IAAEN,GAAE,UAAU,GAAE,IAAE,EAAEH,IAAES,IAAEN,EAAC;AAAE,SAAO,EAAE,CAAC,KAAG,EAAE,GAAEG,IAAE,CAAC,GAAE,EAAEC,IAAE,GAAE,CAAC,GAAE,EAAE,GAAE,GAAE,CAAC,GAAEP,GAAE,GAAE,GAAEO,EAAC,KAAGD;AAAC;AAAC,IAAM,IAAE,EAAE;AAAV,IAAYC,KAAE,EAAE;AAAhB,IAAkB,IAAE,EAAE;AAAtB,IAAwB,IAAEP,GAAE;",
  "names": ["t", "e", "s", "u", "o", "i", "n", "c", "L", "r", "f"]
}
