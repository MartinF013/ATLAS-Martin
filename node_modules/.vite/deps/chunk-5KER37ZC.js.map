{
  "version": 3,
  "sources": ["../../@arcgis/core/symbols/cim/Rasterizer.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{SymbolHelper as e,slsDashToTemplateArray as t,CIMSymbolHelper as r}from\"./CIMSymbolHelper.js\";import a from\"./Rect.js\";import{getSDFInfo as i,buildSDF as n}from\"./SDFHelper.js\";import{resampleHermite as s}from\"./utils.js\";const o=512;class m{constructor(e){this._resourceManager=e}dispose(){this._rasterizationCanvas=null}rasterizeJSONResource(s,o,m){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement(\"canvas\")),\"simple-fill\"===s.type||\"esriSFS\"===s.type){const[t,r,a]=e.rasterizeSimpleFill(this._rasterizationCanvas,s.style,o);return{size:[r,a],image:new Uint32Array(t.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if(\"simple-line\"===s.type||\"esriSLS\"===s.type||\"line\"===s.type&&s.dashTemplate){let r,a;if(\"simple-line\"===s.type||\"esriSLS\"===s.type)switch(r=t(s.style,s.cap),s.cap){case\"butt\":a=\"Butt\";break;case\"square\":a=\"Square\";break;default:a=\"Round\"}else r=s.dashTemplate,a=s.cim.capStyle;const[i,n,o]=e.rasterizeSimpleLine(r,a);return{size:[n,o],image:new Uint32Array(i.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let l,c,f;if(\"simple-marker\"===s.type||\"esriSMS\"===s.type||\"line-marker\"===s.type?(l=r.fromSimpleMarker(s),f=i(l)):s.cim&&\"CIMHatchFill\"===s.cim.type?(l=r.fromCIMHatchFill(s.cim),c=new a(l.frame.xmin,-l.frame.ymax,l.frame.xmax-l.frame.xmin,l.frame.ymax-l.frame.ymin)):s.cim.markerPlacement&&\"CIMMarkerPlacementInsidePolygon\"===s.cim.markerPlacement.type?(l=r.fromCIMInsidePolygon(s.cim),c=new a(l.frame.xmin,-l.frame.ymax,l.frame.xmax-l.frame.xmin,l.frame.ymax-l.frame.ymin)):(l=s.cim,f=i(l)),f&&!m){const[e,t,r]=n(f);return e?{size:[t,r],image:new Uint32Array(e.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const[p,h,u,y,d]=r.rasterize(this._rasterizationCanvas,l,c,this._resourceManager,!m);return p?{size:[h,u],image:new Uint32Array(p.buffer),sdf:!1,simplePattern:!1,anchorX:y,anchorY:d}:null}rasterizeImageResource(e,t,r,a){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement(\"canvas\")),this._rasterizationCanvas.width=e,this._rasterizationCanvas.height=t;const i=this._rasterizationCanvas.getContext(\"2d\");r instanceof ImageData?i.putImageData(r,0,0):(r.setAttribute(\"width\",`${e}px`),r.setAttribute(\"height\",`${t}px`),i.drawImage(r,0,0,e,t));const n=i.getImageData(0,0,e,t),m=new Uint8Array(n.data);if(a)for(const s of a)if(s&&s.oldColor&&4===s.oldColor.length&&s.newColor&&4===s.newColor.length){const[e,t,r,a]=s.oldColor,[i,n,o,l]=s.newColor;if(e===i&&t===n&&r===o&&a===l)continue;for(let s=0;s<m.length;s+=4)e===m[s]&&t===m[s+1]&&r===m[s+2]&&a===m[s+3]&&(m[s]=i,m[s+1]=n,m[s+2]=o,m[s+3]=l)}let l;for(let s=0;s<m.length;s+=4)l=m[s+3]/255,m[s]=m[s]*l,m[s+1]=m[s+1]*l,m[s+2]=m[s+2]*l;let c=m,f=e,p=t;const h=o;if(f>=h||p>=h){const r=f/p;r>1?(f=h,p=Math.round(h/r)):(p=h,f=Math.round(h*r)),c=new Uint8Array(4*f*p);const a=new Uint8ClampedArray(c.buffer);s(m,e,t,a,f,p,!1)}return{size:[f,p],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}}export{m as default};\n"],
  "mappings": "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",
  "names": ["o", "m", "t", "r", "a", "e", "i", "n", "l", "s"]
}
