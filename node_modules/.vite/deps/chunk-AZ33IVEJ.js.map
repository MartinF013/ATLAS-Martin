{
  "version": 3,
  "sources": ["../../@arcgis/core/libs/i3s/enums.js", "../../@arcgis/core/libs/i3s/I3SModule.js", "../../@arcgis/core/views/3d/layers/SceneLayerWorker.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nvar n,e;!function(n){n[n.None=0]=\"None\",n[n.Int16=1]=\"Int16\",n[n.Int32=2]=\"Int32\"}(n||(n={})),function(n){n[n.Replace=0]=\"Replace\",n[n.Outside=1]=\"Outside\",n[n.Inside=2]=\"Inside\",n[n.Finished=3]=\"Finished\"}(e||(e={}));export{n as IndexType,e as ModificationType};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{getAssetUrl as t}from\"../../assets.js\";function e(){return n||(n=new Promise((t=>import(\"../../chunks/i3s.js\").then((t=>t.i)).then((({default:e})=>{const n=e({locateFile:i,onRuntimeInitialized:()=>t(n)});delete n.then})))).catch((t=>{throw t}))),n}function i(e){return t(`esri/libs/i3s/${e}`)}let n;export{e as get};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{slice as t}from\"../../../core/typedArrayUtil.js\";import{IndexType as r}from\"../../../libs/i3s/enums.js\";import{get as n}from\"../../../libs/i3s/I3SModule.js\";import{NodeIMModificationImpact as o}from\"./i3s/I3SNode.js\";async function s(e){await g();const t=[e.geometryBuffer];return{result:m(e,t),transferList:t}}async function f(e){await g();const r=[e.geometryBuffer],{geometryBuffer:n}=e,o=n.byteLength,s=y._malloc(o),f=new Uint8Array(y.HEAPU8.buffer,s,o);f.set(new Uint8Array(n));const i=y.dracoDecompressPointCloudData(s,f.byteLength);if(y._free(s),i.error.length>0)throw`i3s.wasm: ${i.error}`;const a=i.featureIds?.length>0?t(i.featureIds):null,u=t(i.positions);a&&r.push(a.buffer),r.push(u.buffer);return{result:{positions:u,featureIds:a},transferList:r}}async function i(e){await g(),E(e);const t={buffer:e.buffer};return{result:t,transferList:[t.buffer]}}async function a(e){await g(),b(e)}async function u(e){await g(),y.setLegacySchema(e.context,e.jsonSchema)}function l(e){h(e)}let c,y;function b(e){const t=e.modifications,r=y._malloc(8*t.length),n=new Float64Array(y.HEAPU8.buffer,r,t.length);for(let o=0;o<t.length;++o)n[o]=t[o];y.setModifications(e.context,r,t.length,e.isGeodetic),y._free(r)}function m(n,o){if(!y)return null;const{context:s,localOrigin:f,globalTrafo:i,mbs:a,obb:u,elevationOffset:l,geometryBuffer:c,geometryDescriptor:b,indexToVertexProjector:m,vertexToRenderProjector:d}=n,E=y._malloc(c.byteLength),h=33,g=y._malloc(h*Float64Array.BYTES_PER_ELEMENT),w=new Uint8Array(y.HEAPU8.buffer,E,c.byteLength);w.set(new Uint8Array(c));const A=new Float64Array(y.HEAPU8.buffer,g,h);p(A,f);let _=A.byteOffset+3*A.BYTES_PER_ELEMENT,L=new Float64Array(A.buffer,_);p(L,i),_+=16*A.BYTES_PER_ELEMENT,L=new Float64Array(A.buffer,_),p(L,a),_+=4*A.BYTES_PER_ELEMENT,e(u)&&(L=new Float64Array(A.buffer,_),p(L,u.center),_+=3*A.BYTES_PER_ELEMENT,L=new Float64Array(A.buffer,_),p(L,u.halfSize),_+=3*A.BYTES_PER_ELEMENT,L=new Float64Array(A.buffer,_),p(L,u.quaternion));const I=b,T={isDraco:!1,isLegacy:!1,color:n.layouts.some((e=>e.some((e=>\"color\"===e.name)))),normal:n.needNormals&&n.layouts.some((e=>e.some((e=>\"normalCompressed\"===e.name)))),uv0:n.layouts.some((e=>e.some((e=>\"uv0\"===e.name)))),uvRegion:n.layouts.some((e=>e.some((e=>\"uvRegion\"===e.name)))),featureIndex:I.featureIndex},P=y.process(s,!!n.obb,E,w.byteLength,I,T,g,l,m,d,n.normalReferenceFrame);if(y._free(g),y._free(E),P.error.length>0)throw`i3s.wasm: ${P.error}`;if(P.discarded)return null;const U=P.componentOffsets.length>0?t(P.componentOffsets):null,B=P.featureIds.length>0?t(P.featureIds):null,F=t(P.interleavedVertedData).buffer,M=P.indicesType===r.Int16?t(new Uint16Array(P.indices.buffer,P.indices.byteOffset,P.indices.byteLength/2)):t(new Uint32Array(P.indices.buffer,P.indices.byteOffset,P.indices.byteLength/4)),S=t(P.positions),x=P.positionIndicesType===r.Int16?t(new Uint16Array(P.positionIndices.buffer,P.positionIndices.byteOffset,P.positionIndices.byteLength/2)):t(new Uint32Array(P.positionIndices.buffer,P.positionIndices.byteOffset,P.positionIndices.byteLength/4)),O={layout:n.layouts[0],interleavedVertexData:F,indices:M,hasColors:P.hasColors,hasModifications:P.hasModifications,positionData:{data:S,indices:x}};return B&&o.push(B.buffer),U&&o.push(U.buffer),o.push(F),o.push(M.buffer),o.push(S.buffer),o.push(x.buffer),{componentOffsets:U,featureIds:B,transformedGeometry:O,obb:P.obb}}function d(e){return 0===e?o.Unmodified:1===e?o.PotentiallyModified:2===e?o.Culled:o.Unknown}function E(e){const{context:t,buffer:r}=e,n=y._malloc(r.byteLength),o=r.byteLength/Float64Array.BYTES_PER_ELEMENT,s=new Float64Array(y.HEAPU8.buffer,n,o),f=new Float64Array(r);s.set(f),y.filterOBBs(t,n,o),f.set(s),y._free(n)}function h(e){y&&y.destroy(e)}function p(e,t){for(let r=0;r<t.length;++r)e[r]=t[r]}function g(){return y?Promise.resolve():(c||(c=n().then((e=>{y=e,c=null}))),c)}const w={transform:m,destroy:h};export{l as destroyContext,f as dracoDecompressPointCloudData,i as filterObbsForModifications,E as filterObbsForModificationsSync,g as initialize,d as interpretObbModificationResults,s as process,u as setLegacySchema,a as setModifications,b as setModificationsSync,w as test};\n"],
  "mappings": "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",
  "names": ["n", "e", "n", "t", "e", "t", "r", "n", "o", "s", "f", "i", "a", "u", "l", "c", "b", "m", "d", "E", "h", "g", "w"]
}
