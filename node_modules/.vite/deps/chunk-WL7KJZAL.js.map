{
  "version": 3,
  "sources": ["../../@arcgis/core/views/2d/layers/features/support/rendererUtils.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../core/Error.js\";import r from\"../../../../../core/has.js\";import t from\"../../../../../core/Logger.js\";import{toPt as o}from\"../../../../../core/screenUtils.js\";import{getWebGLCapabilities as s}from\"../../../../webgl/capabilities.js\";const l=8,a=l-2,n=t.getLogger(\"esri.views.2d.layers.features.support.rendererUtils\"),i=e=>{if(!(\"visualVariables\"in e)||!e.visualVariables||!e.visualVariables.length)return e;const r=e.clone(),t=r.visualVariables.map((e=>p(e)?c(e):e));return r.visualVariables=t,r};function u(e){return e.map((e=>p(e)?c(e.clone()):e))}function p(e){return(\"size\"===e.type||\"color\"===e.type||\"opacity\"===e.type)&&null!=e.stops}function c(e){return e.stops=g(e.type,e.stops),e}function f(e,r,t){return(1-t)*e+t*r}function b(e,r){const[t,...s]=r,l=s.pop(),n=s[0].value,i=s[s.length-1].value,u=(i-n)/a,p=[];for(let a=n;a<i;a+=u){let t=0;for(;a>=s[t].value;)t++;const l=s[t],n=r[t-1],i=a-n.value,u=l.value===n.value?1:i/(l.value-n.value);if(\"color\"===e){const e=s[t],o=r[t-1],l=e.color.clone();l.r=f(o.color.r,l.r,u),l.g=f(o.color.g,l.g,u),l.b=f(o.color.b,l.b,u),l.a=f(o.color.a,l.a,u),p.push({value:a,color:l,label:e.label})}else if(\"size\"===e){const e=s[t],l=r[t-1],n=o(e.size),i=f(o(l.size),n,u);p.push({value:a,size:i,label:e.label})}else{const e=s[t],o=f(r[t-1].opacity,e.opacity,u);p.push({value:a,opacity:o,label:e.label})}}return[t,...p,l]}function m(e){const[r,...t]=e,o=t.pop();for(;t.length>a;){let e=0,r=0;for(let o=1;o<t.length;o++){const s=t[o-1],l=t[o],a=Math.abs(l.value-s.value);a>r&&(r=a,e=o)}t.splice(e,1)}return[r,...t,o]}function g(e,r){return r.length<=l?r:(n.warn(`Found ${r.length} Visual Variable stops, but MapView only supports ${l}. Displayed stops will be simplified.`),r.length>2*l?b(e,r):m(r))}function h(){if(r(\"heatmap-force-raster\"))return\"raster\";const{supportsTextureFloat:e,supportsTextureHalfFloat:t,supportsColorBufferFloat:o,supportsColorBufferFloatBlend:l,supportsColorBufferHalfFloat:a}=s(\"2d\");return e&&o&&l||t&&a?\"symbol\":r(\"heatmap-allow-raster-fallback\")?\"raster\":\"none\"}function v(t){if(!t)return!0;switch(t.type){case\"dot-density\":if(!s(\"2d\").supportsTextureFloat)return n.error(new e(\"webgl-missing-extension\",\"Missing WebGL extension OES_Texture_Float which is required for DotDensity\")),!1;break;case\"heatmap\":{const t=h();if(\"none\"===t||\"raster\"===t&&!r(\"heatmap-force-raster\")){const r=s(\"2d\"),o=[\"supportsTextureFloat\",\"supportsTextureHalfFloat\",\"supportsColorBufferFloat\",\"supportsColorBufferFloatBlend\",\"supportsColorBufferHalfFloat\"].filter((e=>!r[e])).join(\", \");if(\"none\"===t)return n.errorOnce(new e(\"webgl-missing-extension\",`Missing WebGL${r.type} requirements for Heatmap: ${o}`)),!1;\"raster\"===t&&n.warnOnce(`Missing WebGL${r.type} requirements for accelerated Heatmap: ${o}. Feature support may be limited.`)}break}}return!0}export{h as getSupportedHeatmapRenderer,v as isRendererSupported,i as simplifyVVRenderer,u as simplifyVisualVariables};\n"],
  "mappings": "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",
  "names": ["l", "a", "e", "s", "n", "i", "u", "p", "t", "o", "r"]
}
