{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/interactive/visualElements/PointVisualElement.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{clamp as e,nextHighestPowerOfTwo as t}from\"../../../../core/mathUtils.js\";import{isSome as r,isNone as i}from\"../../../../core/maybe.js\";import{s}from\"../../../../chunks/vec3.js\";import{c as o}from\"../../../../chunks/vec3f64.js\";import{g as n,c as a}from\"../../../../chunks/vec4.js\";import{f as l}from\"../../../../chunks/vec4f64.js\";import{projectVectorToVector as u}from\"../../../../geometry/projection.js\";import{expandWithBuffer as c}from\"../../../../geometry/support/aaBoundingBox.js\";import{sv3d as h}from\"../../../../geometry/support/vectorStacks.js\";import{VisualElementResources as m}from\"./VisualElementResources.js\";import{evaluateElevationAlignmentAtPoint as p}from\"../../layers/graphics/elevationAlignmentUtils.js\";import{ElevationContext as g}from\"../../layers/graphics/ElevationContext.js\";import{createTexture as d,DEFAULT_SYMBOL_SIZE_RATIO as _}from\"../../layers/graphics/sdfPrimitives.js\";import f from\"../../webgl-engine/lib/GeometryUtil.js\";import{VertexAttribute as y}from\"../../webgl-engine/lib/VertexAttribute.js\";import{HUDMaterial as v}from\"../../webgl-engine/materials/HUDMaterial.js\";class S{constructor(e){this.view=null,this._geometry=null,this._size=3,this._color=l(1,0,1,1),this._pixelSnappingEnabled=!0,this._primitive=\"square\",this._outlineSize=1,this._outlineColor=l(1,1,1,1),this._elevationInfo=null,this.resources=new m({view:e.view,createResources:e=>this._createResources(e),recreateGeometry:(e,t)=>(e.geometry=this._recreateGeometry(t,e.material),r(e.geometry)?[e.geometry]:[])});let t=!0;for(const r in e)r in this?\"attached\"===r?t=e[r]:this[r]=e[r]:console.error(\"Cannot set unknown property\",r);this.attached=t}destroy(){this.resources.destroy()}get visible(){return this.resources.visible}set visible(e){this.resources.visible=e}get attached(){return this.resources.attached}set attached(e){this.resources.attached=e}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.resources.recreateGeometry()}get size(){return this._size}set size(e){if(e!==this._size){const t=this.preferredTextureSize;this._size=e,t<this.preferredTextureSize?r(this.resources)&&this.resources.recreate():this._updateSizeAttribute()}}get color(){return this._color}set color(e){n(e,this._color)||(a(this._color,e),this._updateMaterial())}get pixelSnappingEnabled(){return this._pixelSnappingEnabled}set pixelSnappingEnabled(e){this._pixelSnappingEnabled!==e&&(this._pixelSnappingEnabled=e,this._updateMaterial())}get primitive(){return this._primitive}set primitive(e){this._primitive!==e&&(this._primitive=e,r(this.resources)&&this.resources.recreate())}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(e){n(e,this._outlineColor)||(a(this._outlineColor,e),this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.resources&&this.resources.recreateGeometry()}_updateMaterial(){const e=this.resources.resources;i(e)||e.material.setParameters(this._materialParameters(e.texture.id))}_updateSizeAttribute(){const e=this.resources.resources,t=this.resources.object;if(i(e)||i(t))return;const r=e.geometry;if(i(r))return;const s=r.getMutableAttribute(y.SIZE).data,o=this.geometrySize;s[0]=o,s[1]=o,t.geometryVertexAttrsUpdated(t.geometryRecords[0])}_materialParameters(e){return{color:this._color,textureIsSignedDistanceField:!0,distanceFieldBoundingBox:z,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:e,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled}}get geometrySize(){return this._size/b}_recreateGeometry(e,t){const i=this._createRenderGeometry();return r(i)&&e.addGeometry(i,t),i}_createResources(e){const t=d(this._primitive,this.preferredTextureSize),i=new v(this._materialParameters(t.id)),s=this._recreateGeometry(e,i);return{material:i,texture:t,geometry:s,forEach(e){e(t),e(i),r(this.geometry)&&e(this.geometry)}}}get preferredTextureSize(){return e(t(2*this.geometrySize),16,128)}calculateMapBounds(e){if(i(this.resources.resources)||i(this.resources.resources.geometry))return!1;const t=this.resources.resources.geometry.vertexAttributes.get(y.POSITION);return u(t.data,this.view.renderCoordsHelper.spatialReference,x,this.view.spatialReference),c(e,x),!0}_createRenderGeometry(){const e=this.geometry;if(i(e))return null;const{renderCoordsHelper:t,elevationProvider:r}=this.view,o=p(e,r,g.fromElevationInfo(this.elevationInfo),t),n=s(h.get(),e.x,e.y,o),a=h.get();u(n,e.spatialReference,a,t.spatialReference);const l=this.geometrySize;return f.createPointGeometry(null,a,null,[l,l],[0,0,0,1])}}const b=_,z=[b/2,b/2,1-b/2,1-b/2],x=o();export{S as PointVisualElement};\n"],
  "mappings": "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",
  "names": ["r", "e", "t", "o", "a", "n"]
}
