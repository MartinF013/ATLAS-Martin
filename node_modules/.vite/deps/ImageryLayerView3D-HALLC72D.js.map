{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/layers/ImageryLayerView3D.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{isNone as t}from\"../../../core/maybe.js\";import{debounce as a}from\"../../../core/promiseUtils.js\";import{when as i}from\"../../../core/reactiveUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/set.js\";import{subclass as r}from\"../../../core/accessorSupport/decorators/subclass.js\";import s from\"./DynamicLayerView3D.js\";import o from\"../../layers/ImageryLayerView.js\";let n=class extends(o(s)){constructor(){super(...arguments),this.type=\"imagery-3d\",this.redrawDebounced=a((async e=>{this.redraw(((e,t)=>this._redrawImage(e,t)),e)}),2e3)}initialize(){this.handles.add([i((()=>this.view.basemapTerrain.ready),(()=>this._initializeMaximumDataResolution()),{once:!0,initial:!0}),this.layer.on(\"redraw\",(()=>this.updatingHandles.addPromise(this.redrawDebounced())))]),this.updatingHandles.add((()=>this.layer?.exportImageServiceParameters?.version),(()=>{this.updatingHandles.addPromise(this.refreshDebounced())})),this.updatingHandles.add((()=>this.timeExtent),(()=>this.updatingHandles.addPromise(this.refreshDebounced())))}_initializeMaximumDataResolution(){const e=this.view.basemapTerrain.spatialReference,t=this.layer.fullExtent;!t||e.equals(t.spatialReference),this.maximumDataResolution={x:this.layer.pixelSizeX,y:this.layer.pixelSizeY}}getFetchOptions(){return{timeExtent:this.timeExtent}}async processResult(e,t,a){t.imageElement?e.image=t.imageElement:(e.image=document.createElement(\"canvas\"),e.pixelData=t.pixelData,await this._redrawImage(e,a))}async _redrawImage(e,a){if(!(e.image instanceof HTMLCanvasElement)||t(e.pixelData))throw new Error;const i=e.image,r=i.getContext(\"2d\"),s=await this.layer.applyRenderer(e.pixelData,{signal:a}),o=this.layer.applyFilter(s).pixelBlock;if(t(o))throw new Error;i.width=o.width,i.height=o.height;const n=r.createImageData(o.width,o.height);n.data.set(o.getAsRGBA()),r.putImageData(n,0,0)}};n=e([r(\"esri.views.3d.layers.ImageryLayerView3D\")],n);const m=n;export{m as default};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIyjB,IAAIA,KAAE,cAAc,EAAE,CAAC,EAAE;AAAA,EAAC,cAAa;AAAC,UAAM,GAAG,SAAS,GAAE,KAAK,OAAK,cAAa,KAAK,kBAAgB,EAAG,OAAMC,OAAG;AAAC,WAAK,OAAQ,CAACA,IAAEC,OAAI,KAAK,aAAaD,IAAEC,EAAC,GAAGD,EAAC;AAAA,IAAC,GAAG,GAAG;AAAA,EAAC;AAAA,EAAC,aAAY;AAAC,SAAK,QAAQ,IAAI,CAAC,EAAG,MAAI,KAAK,KAAK,eAAe,OAAQ,MAAI,KAAK,iCAAiC,GAAG,EAAC,MAAK,MAAG,SAAQ,KAAE,CAAC,GAAE,KAAK,MAAM,GAAG,UAAU,MAAI,KAAK,gBAAgB,WAAW,KAAK,gBAAgB,CAAC,CAAE,CAAC,CAAC,GAAE,KAAK,gBAAgB,IAAK,MAAE;AAJl+B;AAIo+B,8BAAK,UAAL,mBAAY,iCAAZ,mBAA0C;AAAA,OAAU,MAAI;AAAC,WAAK,gBAAgB,WAAW,KAAK,iBAAiB,CAAC;AAAA,IAAC,CAAE,GAAE,KAAK,gBAAgB,IAAK,MAAI,KAAK,YAAa,MAAI,KAAK,gBAAgB,WAAW,KAAK,iBAAiB,CAAC,CAAE;AAAA,EAAC;AAAA,EAAC,mCAAkC;AAAC,UAAMA,KAAE,KAAK,KAAK,eAAe,kBAAiBC,KAAE,KAAK,MAAM;AAAW,KAACA,MAAGD,GAAE,OAAOC,GAAE,gBAAgB,GAAE,KAAK,wBAAsB,EAAC,GAAE,KAAK,MAAM,YAAW,GAAE,KAAK,MAAM,WAAU;AAAA,EAAC;AAAA,EAAC,kBAAiB;AAAC,WAAM,EAAC,YAAW,KAAK,WAAU;AAAA,EAAC;AAAA,EAAC,MAAM,cAAcD,IAAEC,IAAE,GAAE;AAAC,IAAAA,GAAE,eAAaD,GAAE,QAAMC,GAAE,gBAAcD,GAAE,QAAM,SAAS,cAAc,QAAQ,GAAEA,GAAE,YAAUC,GAAE,WAAU,MAAM,KAAK,aAAaD,IAAE,CAAC;AAAA,EAAE;AAAA,EAAC,MAAM,aAAaA,IAAE,GAAE;AAAC,QAAG,EAAEA,GAAE,iBAAiB,sBAAoB,EAAEA,GAAE,SAAS;AAAE,YAAM,IAAI;AAAM,UAAM,IAAEA,GAAE,OAAM,IAAE,EAAE,WAAW,IAAI,GAAE,IAAE,MAAM,KAAK,MAAM,cAAcA,GAAE,WAAU,EAAC,QAAO,EAAC,CAAC,GAAE,IAAE,KAAK,MAAM,YAAY,CAAC,EAAE;AAAW,QAAG,EAAE,CAAC;AAAE,YAAM,IAAI;AAAM,MAAE,QAAM,EAAE,OAAM,EAAE,SAAO,EAAE;AAAO,UAAMD,KAAE,EAAE,gBAAgB,EAAE,OAAM,EAAE,MAAM;AAAE,IAAAA,GAAE,KAAK,IAAI,EAAE,UAAU,CAAC,GAAE,EAAE,aAAaA,IAAE,GAAE,CAAC;AAAA,EAAC;AAAC;AAAEA,KAAE,EAAE,CAAC,EAAE,yCAAyC,CAAC,GAAEA,EAAC;AAAE,IAAMG,KAAEH;",
  "names": ["n", "e", "t", "m"]
}
