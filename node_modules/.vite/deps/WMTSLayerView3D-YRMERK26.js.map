{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/layers/WMTSLayerView3D.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Collection.js\";import i from\"../../../core/Logger.js\";import{isSome as r,isNone as s}from\"../../../core/maybe.js\";import{whenOnce as o}from\"../../../core/reactiveUtils.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as l}from\"../../../core/accessorSupport/decorators/subclass.js\";import{getTileMaxtrixSetFromActiveLayer as n}from\"../../../layers/support/layerUtils.js\";import{LayerView3D as h}from\"./LayerView3D.js\";import{TiledLayerView3D as m}from\"./TiledLayerView3D.js\";import p from\"../../layers/LayerView.js\";import c from\"../../layers/RefreshableLayerView.js\";const d=i.getLogger(\"esri.views.3d.layers.WMTSLayerView3d\");let f=class extends(c(m(h(p)))){constructor(){super(...arguments),this.type=\"wmts-3d\"}get hasMixedImageFormats(){return!0}_getCompatibleTileInfoMatrixSet(e,i=!1){const s=n(this.layer);if(r(s)){if(t.isCollection(s)){const t=s.find((t=>{const s=e(t);return r(s)&&(i?d.error(\"The selected tile matrix set is not compatible with the view\",s):this.addResolvingPromise(Promise.reject(s))),null==s}));return t}const o=e(s);return r(o)&&(i?d.error(\"The selected tile matrix set is not compatible with the view\",o):this.addResolvingPromise(Promise.reject(o))),s}return null}initialize(){this._getCompatibleTileInfoMatrixSet((e=>this._getTileInfoSupportError(e.tileInfo,e.fullExtent)));const e=o((()=>this.view?.basemapTerrain?.tilingSchemeLocked)).then((()=>{const e=this._getCompatibleTileInfoMatrixSet((e=>this._getTileInfoSupportError(e.tileInfo,e.fullExtent)||this._getTileInfoCompatibilityError(e.tileInfo,this.view.basemapTerrain.tilingScheme)));s(e)||(this.layer.activeLayer.tileMatrixSetId!==e.id&&(this.layer.activeLayer.tileMatrixSetId=e.id),this.tileInfo=e.tileInfo,this.layer.fullExtent=e.fullExtent)}));this.addResolvingPromise(e),this.when((()=>this._initialized()))}refresh(){this.emit(\"data-changed\")}canResume(){if(!super.canResume())return!1;const e=this.layer.activeLayer.tileMatrixSet;return e&&!this._getTileInfoError(e.tileInfo,e.fullExtent)}async doRefresh(){this.suspended||this.emit(\"data-changed\")}_initialized(){this.updatingHandles.add((()=>this.layer?.activeLayer?.styleId),(()=>this.refresh())),this.updatingHandles.add((()=>this.layer?.activeLayer),(e=>{const t=this._getCompatibleTileInfoMatrixSet((e=>this._getTileInfoSupportError(e.tileInfo,e.fullExtent)||this._getTileInfoCompatibilityError(e.tileInfo,this.view.basemapTerrain.tilingScheme)),!0);r(t)&&e.tileMatrixSetId!==t.id&&(this.layer.activeLayer.tileMatrixSetId=t.id),this.notifyChange(\"suspended\"),this.canResume()&&this.refresh()}))}_getTileInfoError(e,t){return this._getTileInfoSupportError(e,t)||this._getTileInfoCompatibilityError(e,this.view.basemapTerrain.tilingScheme)}};e([a({readOnly:!0})],f.prototype,\"hasMixedImageFormats\",null),e([a()],f.prototype,\"layer\",void 0),e([a()],f.prototype,\"suspended\",void 0),f=e([l(\"esri.views.3d.layers.WMTSLayerView3D\")],f);const y=f;export{y as default};\n"],
  "mappings": "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",
  "names": ["d", "f", "n", "e", "i", "s", "t", "j"]
}
