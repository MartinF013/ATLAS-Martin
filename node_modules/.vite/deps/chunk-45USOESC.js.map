{
  "version": 3,
  "sources": ["../../@arcgis/core/support/requestPresets.js", "../../@arcgis/core/portal/support/layersLoader.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../request.js\";async function n(n){const{data:o}=await e(n,{responseType:\"json\",query:{f:\"json\"}});return o}export{n as requestArcGISServiceJSON};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{layerLookupMap as t}from\"../../layers/support/lazyLayerLoader.js\";import r from\"../Portal.js\";import{createForItemRead as n}from\"./jsonContext.js\";import{loadStyleRenderer as a}from\"../../renderers/support/styleUtils.js\";import{requestArcGISServiceJSON as o}from\"../../support/requestPresets.js\";async function l(e,t){const r=e.instance.portalItem;if(r&&r.id)return await r.load(t),s(e),i(e,t)}function s(t){const r=t.instance.portalItem;if(!t.supportedTypes.includes(r.type))throw new e(\"portal:invalid-layer-item-type\",\"Invalid layer item type '${type}', expected '${expectedType}'\",{type:r.type,expectedType:t.supportedTypes.join(\", \")})}async function i(e,t){const r=e.instance,o=r.portalItem,{url:l,title:s}=o,i=n(o);if(\"group\"===r.type)return r.read({title:s},i),u(r,e);l&&r.read({url:l},i);const c=await d(e,t);return c&&r.read(c,i),r.resourceReferences={portalItem:o,paths:i.readResourcePaths},r.read({title:s},i),a(r,i)}function u(r,n){let a;const o=r.portalItem.type;switch(o){case\"Feature Service\":case\"Feature Collection\":a=t.FeatureLayer;break;case\"Stream Service\":a=t.StreamLayer;break;case\"Scene Service\":a=t.SceneLayer;break;default:throw new e(\"portal:unsupported-item-type-as-group\",`The item type '${o}' is not supported as a 'IGroupLayer'`)}let l;return a().then((e=>(l=e,d(n)))).then((async e=>\"Feature Service\"===o?(e=await f(e,r.portalItem.url),p(r,l,e)):I(e)>0?p(r,l,e):c(r,l)))}function c(e,t){return e.portalItem.url?o(e.portalItem.url).then((r=>{function n(e){return{id:e.id,name:e.name}}r&&p(e,t,{layers:r.layers?.map(n),tables:r.tables?.map(n)})})):Promise.resolve()}function p(e,t,r){let n=r.layers||[];const a=r.tables||[];\"Feature Collection\"===e.portalItem.type&&(n.forEach((e=>{\"Table\"===e?.layerDefinition?.type&&a.push(e)})),n=n.filter((e=>\"Table\"!==e?.layerDefinition?.type))),n.reverse().forEach((n=>{const a=y(e,t,r,n);e.add(a)})),a.reverse().forEach((n=>{const a=y(e,t,r,n);e.tables.add(a)}))}function y(e,t,n,a){const o=new t({portalItem:e.portalItem.clone(),layerId:a.id,sublayerTitleMode:\"service-name\"});if(\"Feature Collection\"===e.portalItem.type){const t={origin:\"portal-item\",portal:e.portalItem.portal||r.getDefault()};o.read(a,t);const l=n.showLegend;null!=l&&o.read({showLegend:l},t)}return o}function d(e,t){if(!1===e.supportsData)return Promise.resolve(void 0);const r=e.instance;return r.portalItem.fetchData(\"json\",t).catch((()=>null)).then((async e=>{if(b(r)){let t,n=!0;return e&&I(e)>0&&(null==r.layerId&&(r.layerId=m(e)),t=h(e,r.layerId),t&&(1===I(e)&&(n=!1),null!=e.showLegend&&(t.showLegend=e.showLegend))),n&&\"service-name\"!==r.sublayerTitleMode&&(r.sublayerTitleMode=\"item-title-and-service-name\"),t}return e}))}async function f(e,t){if(null==e?.layers||null==e?.tables){const r=await o(t);(e=e||{}).layers=e.layers||r?.layers,e.tables=e.tables||r?.tables}return e}function m(e){const t=e.layers;if(t&&t.length)return t[0].id;const r=e.tables;return r&&r.length?r[0].id:null}function h(e,t){const r=e.layers;if(r)for(let a=0;a<r.length;a++)if(r[a].id===t)return r[a];const n=e.tables;if(n)for(let a=0;a<n.length;a++)if(n[a].id===t)return n[a];return null}function I(e){return(e?.layers?.length??0)+(e?.tables?.length??0)}function b(e){return\"stream\"!==e.type&&\"layerId\"in e}export{m as getFirstLayerOrTableId,I as getNumLayersAndTables,l as load,f as preprocessFSItemData};\n"],
  "mappings": "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",
  "names": ["n", "e", "t", "s", "l", "i", "c", "n", "a"]
}
