{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js", "../../@arcgis/core/chunks/ShadedColorMaterial.glsl.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{addCameraPosition as e}from\"./util/View.glsl.js\";import{FloatPassUniform as i}from\"../shaderModules/FloatPassUniform.js\";import{glsl as r}from\"../shaderModules/interfaces.js\";function o(o,n){if(!n.screenSizeEnabled)return;const c=o.vertex;e(c,n),c.uniforms.add(new i(\"perScreenPixelRatio\",((e,i)=>i.camera.perScreenPixelRatio))),c.uniforms.add(new i(\"screenSizeScale\",(e=>e.screenSizeScale))),c.code.add(r`float computeRenderPixelSizeAt( vec3 pWorld ){\nvec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\nfloat viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));\nreturn viewDirectionDistance * perScreenPixelRatio;\n}\nvec3 screenSizeScaling(vec3 position, vec3 anchor){\nreturn position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;\n}`)}export{o as ScreenSizeScaling};\n", "/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport{c as e}from\"./vec4f64.js\";import{ScreenSizeScaling as o}from\"../views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js\";import{ShaderOutput as r}from\"../views/3d/webgl-engine/core/shaderLibrary/ShaderOutputOptions.js\";import{SliceDraw as i}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as a}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{multipassTerrainTest as s}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{symbolAlphaCutoff as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff.js\";import{ColorConversion as l}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{addProjViewLocalOrigin as n}from\"../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\";import{Float3PassUniform as t}from\"../views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js\";import{Float4PassUniform as c}from\"../views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js\";import{glsl as g}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{Matrix4PassUniform as m}from\"../views/3d/webgl-engine/core/shaderModules/Matrix4PassUniform.js\";import{ShaderBuilder as v}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{TransparencyPassType as w}from\"../views/3d/webgl-engine/lib/basicInterfaces.js\";import{VertexAttribute as u}from\"../views/3d/webgl-engine/lib/VertexAttribute.js\";function f(e){const f=new v,b=e.hasMultipassTerrain&&(e.output===r.Color||e.output===r.Alpha);f.include(a),f.include(o,e),f.include(i,e);const{vertex:h,fragment:C}=f;return C.include(l),n(f,e),C.uniforms.add(new c(\"uColor\",(e=>e.color))),f.attributes.add(u.POSITION,\"vec3\"),f.varyings.add(\"vWorldPosition\",\"vec3\"),b&&f.varyings.add(\"depth\",\"float\"),e.screenSizeEnabled&&f.attributes.add(u.OFFSET,\"vec3\"),e.shadingEnabled&&(h.uniforms.add(new m(\"viewNormal\",((e,o)=>o.camera.viewInverseTransposeMatrix))),f.attributes.add(u.NORMAL,\"vec3\"),f.varyings.add(\"vViewNormal\",\"vec3\")),h.code.add(g`\n    void main(void) {\n      vWorldPosition = ${e.screenSizeEnabled?\"screenSizeScaling(offset, position)\":\"position\"};\n  `),e.shadingEnabled&&h.code.add(g`vec3 worldNormal = normal;\nvViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),h.code.add(g`\n    ${b?\"depth = (view * vec4(vWorldPosition, 1.0)).z;\":\"\"}\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  `),b&&f.include(s,e),C.code.add(g`\n    void main() {\n      discardBySlice(vWorldPosition);\n      ${b?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n    `),e.shadingEnabled?(C.uniforms.add(new t(\"shadingDirection\",(e=>e.shadingDirection))),C.uniforms.add(new c(\"shadedColor\",(e=>p(e.shadingTint,e.color)))),C.code.add(g`vec3 viewNormalNorm = normalize(vViewNormal);\nfloat shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\nvec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):C.code.add(g`vec4 finalColor = uColor;`),C.code.add(g`\n      if (finalColor.a < ${g.float(d)}) {\n        discard;\n      }\n      ${e.output===r.Alpha?g`gl_FragColor = vec4(finalColor.a);`:\"\"}\n\n      ${e.output===r.Color?g`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${e.transparencyPassType===w.Color?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}`:\"\"}\n    }\n    `),f}function p(e,o){const r=1-e[3],i=e[3]+o[3]*r;return 0===i?(b[3]=i,b):(b[0]=(e[0]*e[3]+o[0]*o[3]*r)/i,b[1]=(e[1]*e[3]+o[1]*o[3]*r)/i,b[2]=(e[2]*e[3]+o[2]*o[3]*r)/i,b[3]=o[3],b)}const b=e(),h=Object.freeze(Object.defineProperty({__proto__:null,build:f},Symbol.toStringTag,{value:\"Module\"}));export{h as S,f as b};\n"],
  "mappings": "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",
  "names": ["o", "n", "c", "e", "i", "e", "f", "b", "o", "h", "n", "O", "r", "i"]
}
